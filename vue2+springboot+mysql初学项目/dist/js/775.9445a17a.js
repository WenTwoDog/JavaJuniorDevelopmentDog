"use strict";(self["webpackChunkgrad_project"]=self["webpackChunkgrad_project"]||[]).push([[775],{6775:function(e,t,o){o.r(t),o.d(t,{default:function(){return h}});var l=function(){var e=this,t=e._self._c;return t("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[t("el-upload",{staticClass:"upload-demo",attrs:{action:"http://localhost:8090/video/uploadVideo/","on-success":e.getUrl,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,multiple:"",limit:2,"on-exceed":e.handleExceed,"file-list":e.fileList,"before-upload":e.beforeAvatarUpload}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),t("span",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("请上传您的视频(mp4)和图片(jpg)，如果不是头视频可以不上传图片")])],1),t("el-form-item",{attrs:{label:"视频标题"}},[t("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"视频类型"}},[t("el-select",{model:{value:e.form.lessonId,callback:function(t){e.$set(e.form,"lessonId",t)},expression:"form.lessonId"}},e._l(e.lessons,(function(e,o){return t("el-option",{key:o,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"选择系列"}},[t("el-switch",{attrs:{"active-text":"并入现有系列","inactive-text":"创建新系列"},model:{value:e.chooseCollection,callback:function(t){e.chooseCollection=t},expression:"chooseCollection"}}),t("br"),e.chooseCollection?t("el-select",{attrs:{placeholder:"请选择视频所属系列"},model:{value:e.form.collection,callback:function(t){e.$set(e.form,"collection",t)},expression:"form.collection"}},e._l(e.collections,(function(e,o){return t("el-option",{key:o,attrs:{label:e,value:e}})})),1):e._e(),e.chooseCollection?e._e():t("el-input",{model:{value:e.bufferCollection,callback:function(t){e.bufferCollection=t},expression:"bufferCollection"}})],1),t("el-form-item",{attrs:{label:"视频简介"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.form.brief,callback:function(t){e.$set(e.form,"brief",t)},expression:"form.brief"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("立即创建")]),t("el-button",[e._v("取消")])],1)],1)},s=[],i=o(8739),a={inject:["reload"],data(){return{fileList:[],form:{name:"",url:0,date:new Date,lessonId:1,userId:"",imgurl:0,collection:"",leader:0,brief:""},collections:[],chooseCollection:!0,bufferCollection:"",hook:0,lessons:[]}},methods:{getUrl(e){"jpg"==e.dataOne?(this.form.imgurl=e.dataTwo,this.$message("图片已成功上传")):"mp4"==e.dataOne?(this.form.url=e.dataTwo,this.$message("视频已成功上传")):this.$message(e.dataOne)},handleRemove(e,t){console.log(e,t)},handlePreview(e){console.log(e)},handleExceed(e,t){this.$message.warning(`当前限制选择 2 个文件，本次选择了 ${e.length} 个文件，共选择了 ${e.length+t.length} 个文件`)},beforeRemove(e,t){"jpg"===this.getFileType(e)?this.deleteByFilename(this.form.imgurl):this.deleteByFilename(this.form.url)},getCollection(){i.Z.request({baseURL:"http://localhost:8090/",url:"/video/getCollection",method:"get",headers:{"Content-Type":"application/json"}}).then((e=>{this.collections=e.data}))},onSubmit(){if(!this.chooseCollection){if(this.collections.forEach((e=>{this.bufferCollection==e&&(this.$message("该系列重名，请更改系列名称"),this.hook=1)})),this.form.collection=this.bufferCollection,this.form.leader=1,this.hook)return;if(0==this.form.imgurl)return void this.$message("该系列需要一张封面")}0!=this.form.url?this.form.leader?(console.log(this.form),i.Z.request({baseURL:"http://localhost:8090/",url:"/video/addNewVideo",data:this.form,method:"post",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}}).then((e=>{alert(e.data),this.reload()}))):i.Z.request({baseURL:"http://localhost:8090/",url:"/video/addOldVideo",data:this.form,method:"post",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}}).then((e=>{alert("成功上传"),this.reload()})):this.$message("您还未上传视频")},deleteByFilename(e){i.Z.request({baseURL:"http://localhost:8090/",url:"/video/deleteFile",data:e,method:"post",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}}).then((e=>e))},beforeAvatarUpload(e){const t=this.getFileType(e),o="jpg"==t,l="mp4"==t;return o||l||this.$message("请上传jpg或mkv类型"),o||l},getFileType(e){let t=e.name;return t=t.toString(),t=t.substring(t.length-3),t},getLessons(){i.Z.request({baseURL:"http://localhost:8090/",url:"/video/selectLesson",method:"get",headers:{"Content-Type":"application/json"}}).then((e=>{this.lessons=e.data}))}},mounted:function(){this.getCollection(),this.getLessons()}},n=a,r=o(1001),c=(0,r.Z)(n,l,s,!1,null,null,null),h=c.exports}}]);
//# sourceMappingURL=775.9445a17a.js.map